"use strict";(self.webpackChunkcollection_runner=self.webpackChunkcollection_runner||[]).push([[6928],{6928:(e,t,n)=>{n.d(t,{Z:()=>Ke});var i=n(40540),r=n.n(i),s=n(25892),o=n.n(s),a=n(58560),l=n(47838),c=n(7560),d=n(48722),u=n(80429),p=n(74962),h=n(95779),m=n(37110),g=n(10530),v=n(64382),y=n(80519),f=n(9460),x=n(92474),C=n(81397),b=n(56415),I=n(3341),w=n(60607),j=n(43353),k=n(62932),R=n(64490),O=n(28949),_=n(69461),E=n(67490),A=n(29792);class Z{constructor(e,t,n){this.isHydrating=!1,this.hydrationError=!1,this.activeCollectionId=null,this.activeFolderId=void 0,this.activeWorkspaceId=null,this.runIterations=1,this.delay="0",this.saveResponse=!1,this.stopOnError=!0,this.persist=!0,this.runWithEmptyCookieJar=!1,this.saveCookiesAfterRun=!0,this.originalRequestOrder=[],this.collection=null,this.unsubscribeFromCollectionCache=void 0,this.permissions={},this.runItems=null,this.removeEventListeners=null,this.dataFile=null,this.dataFileType=E.RP,this.dataArray=null,this.storage=new A.KVStorage("collection-runner"),(0,k.makeObservable)(this,{isHydrating:!0,activeCollectionId:!0,setActiveCollectionId:k.action,activeFolderId:!0,setActiveFolderId:k.action,hydrate:k.action,runIterations:!0,setRunIterations:k.action,delay:!0,setDelay:k.action,saveResponse:!0,setSaveResponse:k.action,stopOnError:!0,setStopOnError:k.action,persist:!0,setPersist:k.action,runWithEmptyCookieJar:!0,setRunWithEmptyCookieJar:k.action,saveCookiesAfterRun:!0,setSaveCookiesAfterRun:k.action,setIsHydrating:k.action,setCollection:k.action,collection:!0,permissions:!0,runItems:!0,setRunItems:k.action,hydrationError:!0,setHydrationError:k.action,dataFile:!0,setDataFile:k.action,dataFileType:!0,setDataFileType:k.action,dataArray:!0,setDataArray:k.action}),this.hydrate(e,t,n)}setDataFile(e){this.dataFile=e}setDataFileType(e){this.dataFileType=e}setDataArray(e){this.dataArray=e}getRunItems(){var e;return(null==(e=this.runItems)?void 0:e.filter((e=>e.checked)))||[]}getExecutionOrder(){var e;return(null==(e=this.getRunItems())?void 0:e.map((e=>e.id)))||[]}hasCustomRequestOrderOrSelection(){if(!this.collection||!this.collection.requests)return!1;if(this.activeFolderId)return!0;for(const[n,i]of this.originalRequestOrder.entries()){var e,t;if(!i.includes(null==(e=this.runItems)?void 0:e[n].id))return!0;if(null==(t=this.runItems)||!t[n].checked)return!0}return!1}getAgentPayload(){return{collectionId:this.activeCollectionId,folderId:this.activeFolderId,order:this.getExecutionOrder(),hasCustomRequestOrderOrSelection:this.hasCustomRequestOrderOrSelection()}}getAgentOptions(){let e=0;return Number.isNaN(this.delay)||(e=Number.parseInt(this.delay)),{saveCookiesAfterRun:this.saveCookiesAfterRun,stopOnError:this.stopOnError,iterationCount:this.runIterations,delay:e,runWithEmptyCookieJar:this.runWithEmptyCookieJar}}setIsHydrating(e){this.isHydrating=e}async hydrate(e,t,n){var i;this.setIsHydrating(!0),this.setActiveCollectionId(t),this.setActiveFolderId(n),this.setActiveWorkspaceId(e),this.stopOnError=null==(i=await this.storage.get("stopOnError"))||i;const r=new _.MultiCacheObserver(_.cacheClient,[n?(0,R.folderFindOneQuery)({folderId:n,populate:!0}):(0,R.collectionFindOneQuery)({collectionId:t,populate:!0}),(0,R.collectionPermissionsQuery)({collectionId:t})]);this.unsubscribeFromCollectionCache=r.subscribe((e=>{this.onCollectionCacheUpdate(e[0]),this.onCollectionPermissionsUpdate(e[1])}))}onCollectionCacheUpdate(e){var t;const n=null==(t=e.data)?void 0:t.data;n&&(this.setCollection(n),this.setIsHydrating(!1))}onCollectionPermissionsUpdate(e){const t=e.data;t&&(0,k.runInAction)((()=>{this.permissions=t}))}setActiveCollectionId(e){this.activeCollectionId=e}setActiveFolderId(e){this.activeFolderId=e}setActiveWorkspaceId(e){this.activeWorkspaceId=e}setRunIterations(e){this.runIterations=e}setDelay(e){this.delay=e}setSaveResponse(e){this.saveResponse=e}setStopOnError(e){this.stopOnError=e,this.storage.set("stopOnError",e)}setPersist(e){this.persist=e}setRunWithEmptyCookieJar(e){this.runWithEmptyCookieJar=e}setSaveCookiesAfterRun(e){this.saveCookiesAfterRun=e}setCollection(e){this.collection=e;const t=(0,O.d0)(e,this.activeFolderId);this.setRunItems(t)}setRunItems(e){if(this.runItems){const t=[],n=[],i=[];for(const t of e)this.runItems.find((e=>e.id===t.id))||n.push(t);for(const n of this.runItems){const r=e.find((e=>e.id===n.id));r?t.push((0,c.Z)({},r,{checked:n.checked})):i.push(n)}for(const e of n)t.push(e),this.originalRequestOrder.push(e.id);for(const e of i)this.originalRequestOrder=this.originalRequestOrder.filter((t=>t!==e.id));this.runItems=t}else this.runItems=e,this.setOriginalRequestOrder(e.map((e=>e.id)))}setOriginalRequestOrder(e){this.originalRequestOrder=e}setHydrationError(e){this.hydrationError=e}destroy(){var e,t;null==(e=this.unsubscribeFromCollectionCache)||e.call(this),null==(t=this.removeEventListeners)||t.call(this)}}var F=n(52322);const S=r().createContext({}),T=({children:e})=>{if(!(0,w.useInRouterContext)())throw new Error("CollectionRunContextProvider must be used within a Router");const[t]=(0,j.useSearchParams)(),n=t.get("collection"),r=t.get("folder"),{workspaceId:s}=(0,w.useParams)(),o=(0,i.useMemo)((()=>new Z(s,n,r)),[n,r]);return(0,i.useEffect)((()=>()=>o.destroy()),[]),(0,F.jsx)(S.Provider,{value:o,children:e})};var N=n(50916);const D=()=>{const e=r().useContext(S);return[e.isHydrating,e.setIsHydrating]};var P=n(32543),q=n(6790),z=n(46315),H=n.n(z);function W(e){return/^(-|\+)?([1-9]+[0-9]*)$/.test(e)}function L(e){return e-Number.parseFloat(e)+1>=0}const J="string",U="number",B="boolean";const V=async(e,t,n)=>{const i=await(0,q.readFile)({path:e.path}),r=await(async(e,t,n)=>{const i={fileContent:e,fileDataType:t,csvOptions:n.csvOptions};if(i.fileDataType===E.ko){const e=JSON.parse(i.fileContent);if(!Array.isArray(e))throw new TypeError("The JSON must be an array");return e}if(i.fileDataType===E.Hs)return new Promise(((e,t)=>{!function(e,t,{castingConfig:n={}}={}){H()(e,{columns:!0,escape:'"',cast:(e,t)=>function(e,t,n){var i;const r=null==t?void 0:t.index,s=null!=(i=null==n?void 0:n[r])?i:null;if(s)switch(s){case U:if(L(e)||W(e))return Number(e);break;case B:if(["true","false"].includes(e.toLowerCase()))return"true"===e.toLowerCase();break;case J:return e}return t.quoting?e:W(e)?Number.parseInt(e,10):L(e)?Number.parseFloat(e):["true","false"].includes(e.toLowerCase())?"true"===e.toLowerCase():e}(e,t,n),trim:!0,relax:!0,relax_column_count:!0},t)}(i.fileContent,((n,i)=>n?t(n):e(i)),i.csvOptions)}));throw new Error("Could not determine format of data file")})(i,t,n);return r},M=()=>{const e=r().useContext(S);return{dataArray:e.dataArray,setDataArray:e.setDataArray.bind(e),computeDataArray:async t=>{if(e.dataFile)return await V(e.dataFile,e.dataFileType,{csvOptions:{castingConfig:t||{}}})}}};var $=n(688),K=n(92465),Q=n(69730),Y=n(62629),G=n(83223),X=n(35348);const ee=o()(v.Z).withConfig({displayName:"runner-selector-file-preview__DataTypeDropdownContainer",componentId:"sc-e986jh-0"})(["margin-left:-11px;padding-top:var(--spacing-xs);height:var(--spacing-xxl);.aether-dropdown__control .aether-dropdown__single-value{color:var(--content-color-secondary);font-size:var(--text-size-m);}"]),te=o().div.withConfig({displayName:"runner-selector-file-preview__ColumnNameContainer",componentId:"sc-e986jh-1"})(["font-weight:var(--text-weight-bold);font-size:var(--text-size-m);color:var(--content-color-secondary);line-height:var(--line-height-s);"]),ne=o().div.withConfig({displayName:"runner-selector-file-preview__HeaderContainer",componentId:"sc-e986jh-2"})(["display:flex;align-items:center;border-bottom:var(--border-color-default) var(--border-width-default) solid;margin-bottom:var(--spacing-s);"]),ie=o().div.withConfig({displayName:"runner-selector-file-preview__ModalContentWrapper",componentId:"sc-e986jh-3"})(["min-width:max-content;.preview-data-header{flex:0 0 150px;min-height:var(--spacing-xxxl);padding:var(--spacing-zero) 5px;word-break:break-all;align-self:baseline;cursor:text;user-select:text;&.hidden{display:none;}}.preview-data-header-wrapper,.preview-data-row-wrapper{display:flex;align-items:center;&.highlighted-row{background:var(--yellow-10);}}.preview-data-value{flex:0 0 150px;min-height:30px;padding:5px;word-break:break-all;align-self:baseline;cursor:text;user-select:text;&.hidden{display:none;}&.disabled{color:var(--grey-40);align-self:auto;user-select:none;}}.preview-data-value:first-child,.preview-data-header:first-child{flex:0 0 65px;}"]),re=({dataArray:e,handleClose:t,csvDataFileOptions:n,isOpen:i,fileType:r,setCSVFileOptions:s})=>{const o=(()=>{const t=["Iteration"];if(!e||0===e.length)return t;for(const n of Object.keys(e[0]))t.push(n);return t})();return(0,F.jsxs)(X.u_,{isOpen:i,onClose:t,size:"large",children:[(0,F.jsx)(X.xB,{heading:"PREVIEW DATA"}),(0,F.jsx)(X.hz,{children:(0,F.jsxs)(ie,{"data-testid":"preview-data-modal-content-wrapper",children:[(0,F.jsx)(ne,{"data-testid":"preview-data-header-wrapper",children:o.map(((e,t)=>{let i=E.vx.AUTO_DETECT,{label:o}=E.f1[E.vx.AUTO_DETECT];return null!=n&&n[t-1]&&(o=E.f1[n[t-1]].label,i=E.f1[n[t-1]].value),(0,F.jsx)("div",{className:"preview-data-header",children:(0,F.jsxs)(a.Z,{direction:"column",children:[(0,F.jsx)(te,{children:e}),t>0&&"text/csv"===r&&(0,F.jsx)(ee,{onChange:e=>{const t=e.columnIndex-1;null==s||s({index:t,dataType:e.value})},options:Object.values(E.f1).map((e=>({value:`${e.value}`,label:e.label,columnIndex:t}))),value:{value:i,label:o,columnIndex:t},isOptionDisabled:e=>e.isDisabled,isSearchable:!1,isClearable:!1,triggerWidth:"auto",triggerMaxWidth:150,triggerType:"tertiary",triggerSize:"small"})]})},String(e)+t)}))}),e&&e.length>0&&e.map(((e,t)=>(0,F.jsx)("div",{className:"preview-data-header-wrapper",children:o.map(((n,i)=>(0,F.jsx)("div",{className:"preview-data-value",children:0===i?t+1:JSON.stringify(e[n])},String(n)+i+t)))},`header${t}`)))]})})]})},se=o().div.withConfig({displayName:"run-configuration-form__PersistCheckboxContainer",componentId:"sc-1ag1m7z-0"})(["padding-top:var(--spacing-s);padding-bottom:var(--spacing-xs);"]),oe=o().div.withConfig({displayName:"run-configuration-form__AdvancedSettingsWrapper",componentId:"sc-1ag1m7z-1"})(["margin-bottom:var(--spacing-zero) !important;width:fit-content;cursor:pointer;"]),ae=o().div.withConfig({displayName:"run-configuration-form__StartRunButtonWrapper",componentId:"sc-1ag1m7z-2"})(["margin-top:",";width:fit-content;"],(e=>e.isSettingsExpanded?"var(--spacing-zero)":"var(--spacing-m)")),le=o()(u.Z).withConfig({displayName:"run-configuration-form__StyledButton",componentId:"sc-1ag1m7z-3"})(["span{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}:disabled{background-color:var(--button-primary-background-color) !important;color:var(--button-primary-content-color) !important;opacity:0.5;}"]),ce=(0,N.observer)((({planFeatures:e,resourceUsage:t,messageTemplates:n})=>{var s,o,w;const{addToast:j}=(0,l.ZP)(),[k,R]=(0,i.useState)(!1),[O,_]=(0,i.useState)(!1),[A,Z]=(()=>{const e=r().useContext(S);return[e.runIterations,e.setRunIterations.bind(e)]})(),[T,N]=(()=>{const e=r().useContext(S);return[e.delay,e.setDelay.bind(e)]})(),[z,H]=(()=>{const e=r().useContext(S);return[e.saveResponse,e.setSaveResponse.bind(e)]})(),{stopOnError:W,setStopOnError:L,persist:J,setPersist:U,runWithEmptyCookieJar:B,setRunWithEmptyCookieJar:V,saveCookiesAfterRun:X,setSaveCookiesAfterRun:ee}=(()=>{const e=r().useContext(S);return{stopOnError:e.stopOnError,setStopOnError:e.setStopOnError.bind(e),persist:e.persist,setPersist:e.setPersist.bind(e),runWithEmptyCookieJar:e.runWithEmptyCookieJar,setRunWithEmptyCookieJar:e.setRunWithEmptyCookieJar.bind(e),saveCookiesAfterRun:e.saveCookiesAfterRun,setSaveCookiesAfterRun:e.setSaveCookiesAfterRun.bind(e)}})(),[te]=(()=>{const e=r().useContext(S);return[e.collection,e.setCollection]})(),[ne]=D(),ie=(0,P.tZ)(),ce=(()=>{const e=r().useContext(S),{computeDataArray:t}=M(),n=(0,c.Z)({},e.getAgentOptions());return async i=>{if(e.dataFile){const e=await t(i);n.data=e}return{payload:e.getAgentPayload(),agentOptions:n,runOptions:{saveResponse:e.saveResponse,persist:e.persist}}}})(),de=(0,G.v)(),{dataArray:ue,setDataArray:pe,computeDataArray:he}=M(),[me,ge]=(0,i.useState)(null),[ve,ye]=(0,i.useState)(!1),[fe,xe]=(0,i.useState)(!1),Ce=[{label:E.ko,value:E.ko},{label:E.Hs,value:E.Hs},{label:E.RP,value:E.RP}],be=r().useContext(S),Ie=null==n?void 0:n.runner.messages,we=(0,i.useMemo)((()=>(0,Y.DV)(e,t)),[e,t]),je=(0,i.useMemo)((()=>(0,Y.i2)(e,t)),[e,t]),ke=(0,c.Z)({},we,{collectionName:null==(s=be.collection)?void 0:s.name,collectionId:null==(o=be.collection)?void 0:o.id,runnableName:`Run ${null==te?void 0:te.name}`,planName:"planname",applicableThresholdKey:je}),Re=(0,i.useMemo)((()=>(0,Y.Ir)(e,t)),[e,t]);return(0,F.jsxs)(a.Z,{direction:"column",gap:"spacing-m","data-testid":"run-configuration-form-container",children:[(0,F.jsx)(p.Z,{type:"h4",text:"Run configuration"}),(0,F.jsx)(h.Z,{"data-testid":"run-settings-iterations",label:(0,F.jsx)(m.Z,{text:"Iterations"}),type:"number",value:A,onChange:e=>{try{const t=Number.parseInt(e.target.value);if(t<1||Number.isNaN(t))return;Z(t)}catch(e){}},width:"60%"}),(0,F.jsx)(h.Z,{"data-testid":"run-settings-delay",type:"text",label:(0,F.jsx)(m.Z,{text:"Delay"}),value:T,suffix:"ms",onChange:e=>{try{const t=e.target.value;if(Number.isNaN(Number.parseInt(t))&&""!==t)return;N(t)}catch(e){}},width:"60%"}),(0,F.jsx)(g.Z,{label:"Data",id:"file-uploader","data-testid":"run-settings-file-uploader",actionLabel:"Select File",accept:".csv,.json",onChange:async e=>{var t;if(0===(null==e?void 0:e.length))return be.setDataFile(null),be.setDataFileType(E.RP),void ge(null);K.AnalyticsService.addEventV2({category:"collectionrun",action:"data_file_upload_initiate",value:e.length,entityId:null==(t=be.collection)?void 0:t.id,entityType:"collection",label:""});try{const t=await(0,q.processFiles)(e);be.setDataFile(t[0]),be.setDataFileType(t[0].type)}catch(e){if(e){const t="Connection Error"===e.message?E.eL:E.kV;return void j({title:"Couldn't upload file",description:t,status:"error"})}}}}),be.dataFile&&(0,F.jsxs)(a.Z,{justifyContent:"flex-start",alignItems:"flex-end",gap:"spacing-m",children:[(0,F.jsx)("div",{style:{flex:"0 1 40%"},children:(0,F.jsx)(v.Z,{"data-testid":"run-settings-dataType",options:Ce,value:{label:be.dataFileType||E.RP,value:be.dataFileType||E.RP},onChange:e=>{be.setDataFileType(e.value),he(me).then((e=>{pe(e),xe(!1)})).catch((e=>{j({description:e.message,status:"error"}),xe(!0)}))},isClearable:!1,isSearchable:!1,label:"Data File Type"})}),(0,F.jsx)(u.Z,{"data-testid":"run-settings-dataPreview",type:"secondary",text:"Preview",onClick:()=>{he(me).then((e=>{pe(e),ye(!0),xe(!1)})).catch((e=>{j({description:e.message,status:"error"}),xe(!0)}))}})]}),(0,F.jsx)(re,{dataArray:ue,isOpen:ve,csvDataFileOptions:me||{},setCSVFileOptions:e=>{if(null===e)return void ge(null);const{index:t,dataType:n}=e;ge((0,c.Z)({},me,{[t]:n})),he((0,c.Z)({},me,{[t]:n})).then((e=>{pe(e),ye(!0),xe(!1)})).catch((e=>{j({description:e.message,status:"error"}),xe(!0)}))},fileType:be.dataFileType,handleClose:()=>{ye(!1)}}),(0,F.jsx)(se,{"data-testid":"run-settings-saveResponses-container",children:(0,F.jsx)(y.Z,{"data-testid":"run-settings-saveResponses",isChecked:z,label:"Persist responses for a session",onChange:()=>H(!z),infoText:"Responses are persisted only for a session and not saved permanently. Enabling this may impact performance for large collection runs."})}),(0,F.jsx)(oe,{"data-testid":"runs-advanced-settings-container",onClick:()=>{R(!k)},children:(0,F.jsxs)(a.Z,{alignItems:"center",justifyContent:"flex-start",gap:"spacing-s",padding:{paddingTop:"spacing-xs",paddingLeft:"spacing-zero",paddingBottom:"spacing-zero",paddingRight:"spacing-zero"},children:[k?(0,F.jsx)(b.Z,{color:"content-color-secondary"}):(0,F.jsx)(I.Z,{color:"content-color-secondary"}),(0,F.jsx)(f.ZP,{type:"body-medium",color:"content-color-secondary",children:"Advanced settings"})]})}),(0,F.jsxs)(x.Z,{padding:"spacing-l",isHidden:!k,children:[(0,F.jsx)(y.Z,{"data-testid":"run-settings-stopOnError",isChecked:W,label:"Stop run if an error occurs",onChange:()=>{L(!W)}}),(0,F.jsx)(y.Z,{"data-testid":"run-settings-keepVariables",isChecked:J,label:"Keep variable values",onChange:()=>{U(!J)},infoText:"Enabling this will write the value of the variables at the end of the run to its current value in the session."}),(0,F.jsx)(y.Z,{"data-testid":"run-settings-runWithoutCookies",isChecked:B,label:"Run collection without using stored cookies",onChange:()=>{V(!B)}}),(0,F.jsx)(y.Z,{"data-testid":"run-settings-saveCookiesAfterRun",isChecked:X,label:"Save cookies after collection run",onChange:()=>{ee(!X)},infoText:"Update the cookies stored in this session and save them to your cookie manager."})]}),(0,F.jsx)(ae,{isSettingsExpanded:k,children:(0,F.jsx)(le,{"data-testid":"run-settings-startRun",isLoading:ne||O,isDisabled:ne||Re||fe,text:`Run ${null==te?void 0:te.name}`,size:"medium",type:"primary",onClick:()=>{(async()=>{_(!0);const{planFeatures:e,resourceUsage:t}=await de(),n=await ce(me||{});try{(0,Y.Rf)(e,t);const i=(0,d.v4)();await ie(i,{openInNewTab:!0,loadFromHistory:!1,navigationPayload:n})}finally{_(!1)}})()},tooltip:(0,F.jsx)(C.Z,{content:(0,$.vH)({isNotPermitted:!1,noIterations:!be.runIterations,defaultText:`Run ${null==te?void 0:te.name}`,limitReached:Re&&(0,Y.YH)(e)?(0,$.Cu)(null==n||null==(w=n.buttons)||null==(w=w.run)||null==(w=w.tooltip)?void 0:w[je],ke):null,noCollection:!1,runButtonName:`Run ${null==te?void 0:te.name}`}),openDelay:1500,placement:"bottom"})})}),je&&Ie&&(0,F.jsx)(a.Z,{padding:"spacing-l spacing-zero spacing-zero spacing-zero",width:"70%",minWidth:"350px","data-testid":"run-configuration-usage-limit-message",children:(0,F.jsx)(Q.Z,{config:null==Ie?void 0:Ie[je],variables:ke,onLinkClick:e=>{var t,n;null!=e&&null!=(t=e.analytics)&&t.action&&e.analytics.label&&K.AnalyticsService.addEventV2({category:"runner",action:(0,$.Cu)(e.analytics.action,ke),label:(0,$.Cu)(e.analytics.label,ke),entityId:null!=(n=be.activeFolderId)?n:be.activeCollectionId,entityType:be.activeFolderId?"folder":"collection"})}})})]})}));var de=n(82993),ue=n(71932),pe=n(49437),he=n(22135),me=n(65275),ge=n(57900);const ve=()=>r().useContext(S).runItems;var ye=n(47521),fe=n(68004),xe=n(35547);const Ce=o()(a.Z).withConfig({displayName:"runs-customiser-list-item-parents__ItemParentContainer",componentId:"sc-1y6qlbi-0"})(["display:flex;margin-left:4px;.customizer__row_icons{display:flex;align-items:center;}"]),be=o()(a.Z).withConfig({displayName:"runs-customiser-list-item-parents__ParentIconContainer",componentId:"sc-1y6qlbi-1"})(["align-items:center;margin-right:var(--spacing-xs) !important;"]),Ie=({item:e})=>(0,F.jsx)(F.Fragment,{children:e.parents.map((e=>(0,F.jsxs)(Ce,{"data-testid":"run-item-parent-container",children:[(0,F.jsx)(be,{children:(0,F.jsx)(C.Z,{content:e.name,placement:"bottom",children:(0,F.jsx)(xe.Z,{"data-testid":"run-item-parent-icon"})})}),(0,F.jsx)(I.Z,{})]})))}),we=o()(a.Z).withConfig({displayName:"runs-customiser-list-item__RunsCustomiserListItemContainer",componentId:"sc-y77uah-0"})(["height:var(--spacing-xxl);align-items:center;position:relative;box-shadow:",";opacity:",";:hover:not(div[data-aether-id='aether-checkbox'],i,svg){background-color:var(--highlight-background-color-secondary);}.runner-runs-customizer__list{margin-left:24px;}"],(e=>e.dropHoverTop&&e.isDragOver?"0 2px 0 var(--base-color-brand) inset":e.dropHoverBottom&&e.isDragOver?"0 2px 0 var(--base-color-brand)":""),(e=>e.isDragging?"0.1":"1")),je=o().div.withConfig({displayName:"runs-customiser-list-item__SortIconContainer",componentId:"sc-y77uah-1"})(["opacity:0;padding:0 var(--spacing-xs);cursor:grab;:hover{opacity:1;}"]),ke=o()(y.Z).withConfig({displayName:"runs-customiser-list-item__StyledCheckbox",componentId:"sc-y77uah-2"})(["margin-right:var(--spacing-xs) !important;"]),Re=o()(a.Z).withConfig({displayName:"runs-customiser-list-item__ItemNameContainer",componentId:"sc-y77uah-3"})(["white-space:nowrap;"]),Oe=({index:e,item:t})=>{const n=(0,i.useRef)(null),s=(()=>{const e=r().useContext(S);return t=>{var n;const i=null==(n=e.runItems)?void 0:n[t];i&&(i.checked=!i.checked)}})(),[o,a]=(0,i.useState)(!1),[l,c]=(0,i.useState)(!1),d=(()=>{const e=r().useContext(S);return(0,i.useCallback)(((t,n)=>{const i=e.runItems;if(!i)return;const r=i[t];(0,k.runInAction)((()=>{i.splice(t,1),i.splice(n,0,r)}))}),[])})(),[{isDragOver:u},p]=(0,ge.useDrop)({accept:"request",collect:e=>({isDragOver:e.isOver({shallow:!0})}),drop:t=>{e===t.index-1&&l||e===t.index+1&&o||d(t.index,e)},hover:(t,i)=>{var r;if(!n.current)return;if(t.index===e)return;const s=null==(r=n.current)?void 0:r.getBoundingClientRect(),o=(s.bottom-s.top)/2,l=i.getClientOffset(),d=(null==l?void 0:l.y)-s.top;"bottom"===(d>o?"bottom":"top")?(c(!0),a(!1)):(c(!1),a(!0))}}),[{isDragging:h},m]=(0,ge.useDrag)({type:"request",item:()=>({index:e}),collect:e=>({isDragging:e.isDragging()})});return m(p(n)),(0,F.jsxs)(we,{ref:n,isDragging:h,isDragOver:u,dropHoverTop:o,dropHoverBottom:l,"data-testid":"runs-list-item-container",children:[(0,F.jsx)(je,{children:(0,F.jsx)(ye.Z,{})}),(0,F.jsx)(ke,{"data-testid":"run-list-item-checkbox",isChecked:t.checked,onChange:()=>s(e)}),(0,F.jsx)(Ie,{item:t}),(0,F.jsx)(fe.C,{method:t.method,size:"small"}),(0,F.jsx)(Re,{children:(0,F.jsx)(f.ZP,{type:"body-medium",color:"content-color-primary",children:t.name})})]})};var _e=n(25451);const Ee=(0,N.observer)((()=>{const e=ve(),[t]=D();return t?(0,F.jsx)(_e.T,{}):(0,F.jsx)(ge.DndProvider,{backend:me.HTML5Backend,children:(0,F.jsx)(a.Z,{direction:"column",width:"100%",children:null==e?void 0:e.map(((e,t)=>(0,F.jsx)(Oe,{index:t,item:(0,c.Z)({},e)},t)))})})}));var Ae=n(77736);const Ze=o().div.withConfig({displayName:"runs-customiser__RunsCustomiserContainer",componentId:"sc-1q3gf7f-0"})(["display:flex;flex-direction:column;flex:1 0 300px;position:relative;margin:var(--spacing-l) var(--spacing-zero) var(--spacing-l) var(--spacing-l);border:var(--border-width-default) var(--border-style-solid) var(--border-color-default);border-radius:var(--border-radius-default);padding:var(--spacing-l);cursor:default;user-select:none;margin-bottom:70px;"]),Fe=o().div.withConfig({displayName:"runs-customiser__RunsCustomiserHeader",componentId:"sc-1q3gf7f-1"})(["margin-bottom:var(--spacing-l);display:flex;justify-content:space-between;"]),Se=o().div.withConfig({displayName:"runs-customiser__CustomisedButtonsContainer",componentId:"sc-1q3gf7f-2"})(["display:flex;align-items:center;"]),Te=o().div.withConfig({displayName:"runs-customiser__Separator",componentId:"sc-1q3gf7f-3"})(["margin:var(--spacing-zero) var(--spacing-xs);background-color:var(--border-color-default);height:var(--size-xs);width:var(--border-width-default);"]),Ne=o().div.withConfig({displayName:"runs-customiser__RunsCustomiserListContainer",componentId:"sc-1q3gf7f-4"})(["flex:1;display:flex;background-color:var(--background-color-primary);contain:strict;min-height:200px;width:100%;"]),De=o()(a.Z).withConfig({displayName:"runs-customiser__ListContainer",componentId:"sc-1q3gf7f-5"})(["padding:var(--spacing-s) var(--spacing-zero);overflow-y:auto;flex:1;width:100%;"]),Pe=o().div.withConfig({displayName:"runs-customiser__StyledEmptyStateContainer",componentId:"sc-1q3gf7f-6"})(["margin:auto;max-width:240px;text-align:center;color:var(--content-color-tertiary);"]),qe=o().div.withConfig({displayName:"runs-customiser__StyledHistoryImportLink",componentId:"sc-1q3gf7f-7"})(["margin-top:24px;"]),ze=(0,N.observer)((()=>{const{hydrationError:e,hydrate:t,isHydrating:n}=(()=>{const e=r().useContext(S);return{isHydrating:e.isHydrating,hydrationError:e.hydrationError,hydrate:()=>{e.hydrate(e.activeWorkspaceId,e.activeCollectionId,e.activeFolderId)}}})(),i=ve(),s=(0,F.jsx)("span",{onClick:()=>{Ae.VSCodeCommunicationsService.postMessageToExtension({type:"SIDEBAR:FOCUS",payload:{activeElement:"history"}})},children:(0,F.jsx)(f.ZP,{type:"link-primary",children:"history."})});return n?(0,F.jsx)(_e.T,{}):e?(0,F.jsx)(pe.Z,{description:"Something went wrong while fetching the collection details",primaryAction:(0,F.jsx)(u.Z,{type:"outline",text:"Retry",onClick:()=>t()}),"data-testid":"hydration-error-container",children:(0,F.jsx)(he.Z,{})}):i&&0!==i.length?(0,F.jsx)(Ne,{children:(0,F.jsx)(a.Z,{direction:"column",width:"100%",children:(0,F.jsx)(De,{children:(0,F.jsx)(Ee,{})})})}):(0,F.jsxs)(Pe,{"data-testid":"run-configuration-no-requests",children:[(0,F.jsx)(f.ZP,{type:"body-medium",color:"content-color-tertiary",children:"This collection is empty. Add a request to get started."}),(0,F.jsxs)(qe,{children:[(0,F.jsx)(f.ZP,{type:"body-medium",color:"content-color-tertiary",children:"You can find your previous collection runs in "}),s]})]})})),He=(0,N.observer)((()=>{const e=(()=>{const e=r().useContext(S);return()=>{(0,k.runInAction)((()=>{if(e.runItems)for(const t of e.runItems)t.checked=!0}))}})(),t=(()=>{const e=r().useContext(S);return()=>{(0,k.runInAction)((()=>{if(e.runItems)for(const t of e.runItems)t.checked=!1}))}})(),n=(()=>{const e=r().useContext(S);return()=>{if(!e.collection)return;const t=[];for(const i of e.originalRequestOrder){var n;const r=null==(n=e.runItems)?void 0:n.find((e=>e.id===i));r&&t.push((0,c.Z)({},r,{checked:!0}))}e.runItems=t}})();return(0,F.jsxs)(Ze,{"data-testid":"runs-customiser-container",children:[(0,F.jsxs)(Fe,{children:[(0,F.jsx)(m.Z,{type:"primary",text:"Run order"}),(0,F.jsxs)(Se,{children:[(0,F.jsx)(u.Z,{type:"tertiary",text:"Deselect All",onClick:()=>t()}),(0,F.jsx)(Te,{}),(0,F.jsx)(u.Z,{type:"tertiary",text:"Select All",onClick:()=>e()}),(0,F.jsx)(Te,{}),(0,F.jsx)(u.Z,{type:"tertiary",text:"Reset",onClick:()=>n()})]})]}),(0,F.jsx)(ze,{})]})}));var We=n(80814),Le=n(12511),Je=n(3062),Ue=n(68414),Be=n(93301);const Ve=o()(a.Z).withConfig({displayName:"collection-run-create__CollectionRunCreateContainer",componentId:"sc-1qxxa1z-0"})(["height:100vh;"]),Me=o()(a.Z).withConfig({displayName:"collection-run-create__RunnerFormContainer",componentId:"sc-1qxxa1z-1"})(["flex-direction:column;max-width:720px;height:100%;scrollbar-gutter:stable;flex-basis:52%;border-top:solid var(--border-width-l) transparent;&::before{content:'';display:block;border-top:solid var(--border-width-default) transparent;}padding:var(--spacing-l);"]),$e=(0,N.observer)((()=>{const e=r().useContext(S),{planFeatures:t,isLoading:n}=(0,Le.b)(),{isLoading:i,resourceUsage:s}=(0,Je.w)(),{messageTemplates:o,isLoading:a}=(0,Ue.A)((null==t?void 0:t.templatePath)||E.df);return(0,R.useCollectionSubscription)({collectionId:e.activeCollectionId||"",workspaceId:(0,Be.useActiveWorkspaceId)()}),e.isHydrating||n||i||a?(0,F.jsx)(_e.T,{}):(0,F.jsxs)(Ve,{children:[(0,F.jsx)(He,{}),(0,F.jsx)(Me,{children:(0,F.jsx)(ce,{planFeatures:t,resourceUsage:s,messageTemplates:o})})]})})),Ke=()=>{const{setTabTitle:e}=(0,We.useTabTitleMeta)();return(0,i.useEffect)((()=>{e(E.$U,"collection-runner")}),[]),(0,F.jsx)(T,{children:(0,F.jsx)(de.U,{children:(0,F.jsxs)(l.VW,{children:[(0,F.jsx)(ue.e,{}),(0,F.jsx)($e,{})]})})})}}}]);
//# sourceMappingURL=6928.859e45e617733d35.js.map