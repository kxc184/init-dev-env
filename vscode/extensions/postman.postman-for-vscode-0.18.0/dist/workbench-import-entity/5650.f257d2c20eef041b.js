"use strict";(self.webpackChunkworkbench_import_entity=self.webpackChunkworkbench_import_entity||[]).push([[5650],{869:(t,e,r)=>{r.d(e,{Z:()=>i});var s=r(2465),a=r(4490),n=r(3301),o=r(7504);const i=()=>{const t=(0,n.useActiveWorkspaceId)(),e=(0,a.useCreateNewCollection)(),r=(0,a.useWorkspacePermissions)(t);return async(a,n)=>{if(!r.userCanCreate)return{status:"error",description:"You do not have permission to import a collection."};const i=await(0,o.z)(n,a.name,"collection");if("cancel"===i)return{status:"error",description:"Import cancelled"};a.name=i;try{return await e.mutateAsync({workspaceId:t,requestBody:a}),s.AnalyticsService.addEventV2({category:"http-collection",action:"create",label:"import",value:1}),{status:"success",description:"Collection imported successfully."}}catch(t){return t.name.includes("TimeoutError")?{status:"error",description:"Import request timed out. Please wait for some time or try again."}:{status:"error",description:"Could not import collection. Please try again."}}}}},4162:(t,e,r)=>{r.d(e,{Z:()=>c});var s=r(7380),a=r(2465),n=r(3301),o=r(9461),i=r(7504);const c=()=>{const t=(0,n.useActiveWorkspaceId)(),e=(0,s.useCreateNewEnvironment)(),{data:r}=(0,o.useDataFetch)((0,s.getEnvironmentSidebarPermissionsQuery)(t));return async(s,n)=>{if(null==r||!r.userCanCreateEnvironment)return{status:"error",description:"You do not have permission to import an environment."};const o=await(0,i.z)(n,s.name,"environment");if("cancel"===o)return{status:"error",description:"Import cancelled"};s.name=o;try{return await e.mutateAsync({workspaceId:t,requestBody:s}),a.AnalyticsService.addEventV2({category:"environment",action:"create",label:"import"}),{status:"success",description:"Environment imported successfully."}}catch(t){return t.name.includes("TimeoutError")?{status:"error",description:"Import request timed out. Please wait for some time or try again."}:{status:"error",description:"Could not import environment. Please try again."}}}}},7504:(t,e,r)=>{r.d(e,{z:()=>n});var s=r(8217),a=r(7380);const n=async(t,e,r)=>{let n=!1;const o=t?t.map((t=>(t.name===e&&(n=!0),t.name))):[];if(n){const t=s.Modals.getModals(),n=await t.showWarningDialog({uid:`${r}-import-duplicate-warning`,subject:"",message:`${"collection"===r?"A collection":"An environment"} ${e} already exists. What would you like to do?`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Import as Copy",isPrimary:!0}]});return n&&"Import as Copy"===n.title?(0,a.getDuplicateEntityName)(o,e):"cancel"}return e}},5650:(t,e,r)=>{r.r(e),r.d(e,{default:()=>s.Z});var s=r(1983)},8123:(t,e,r)=>{r.d(e,{n:()=>n});var s=r(7736),a=r(9907);const n=async t=>{{const e=await s.VSCodeCommunicationsService.postMessageToExtensionAsPromise({type:"IMPORT_FILE",payload:{fileDetails:t,userId:(0,a.getUserId)()}});if(e.err)throw new Error(e.val.message);return e.val}}},1983:(t,e,r)=>{r.d(e,{Z:()=>A});var s=r(7560),a=r(540),n=r(8560),o=r(6085),i=r(425),c=r(5736),l=r(1397),u=r(605),d=r(4962),p=r(5482),m=r(8394),y=r(2054),g=r(5892),h=r.n(g),f=r(1246),w=r(4490),v=r(7380),C=r(3301),I=r(869),x=r(4162),k=r(814),Z=r(8123),b=r(2322);const j=h()(n.Z).withConfig({displayName:"workbench-import-entity__ImportListContainer",componentId:"sc-90lswp-0"})(["margin-top:var(--spacing-l);margin-left:var(--spacing-l);margin-right:var(--spacing-l);flex-direction:column;"]),E=h()(o.Z).withConfig({displayName:"workbench-import-entity__SearchContainer",componentId:"sc-90lswp-1"})(["margin:var(--spacing-xl);"]),N=h()(i.Z).withConfig({displayName:"workbench-import-entity__StyledTable",componentId:"sc-90lswp-2"})(["padding-left:var(--spacing-xl);padding-right:var(--spacing-xl);"]),S=h()(n.Z).withConfig({displayName:"workbench-import-entity__Footer",componentId:"sc-90lswp-3"})(["margin-right:var(--spacing-xl);margin-top:var(--spacing-xl);"]),A=()=>{var t;const e=(0,f.Z)(),[r,n]=(0,a.useState)(""),{setTabTitle:o}=(0,k.useTabTitleMeta)();(0,a.useEffect)((()=>{o("Import","import")}),[o]);const[i,g]=(0,a.useState)(null!=(t=e.data)?t:[]),[h,A]=(0,a.useState)((0,s.Z)({},i.map((()=>!0)))),[_,T]=(0,a.useState)(!1),O=(0,C.useActiveWorkspaceId)(),{data:W}=(0,w.useCollectionList)({workspaceId:O}),{data:P}=(0,v.useEnvironmentItems)({workspaceId:O}),D=(0,I.Z)(),L=(0,x.Z)(),F=_?[{id:"status",accessor:"status",cellWidth:"2%",Cell:({value:t})=>{if(t){if(t.isLoading)return(0,b.jsx)(c.Z,{});if(t.error)return(0,b.jsx)(l.Z,{content:t.error,children:(0,b.jsx)(p.Z,{"data-testid":"import-status-icon",color:"content-color-error"})});if(t.success)return(0,b.jsx)(l.Z,{content:"Imported successfully",children:(0,b.jsx)(m.Z,{"data-testid":"import-status-icon",color:"content-color-success"})})}return null}},{Header:"Name",accessor:"name",cellWidth:"40%"},{Header:"Import As",accessor:"format",cellWidth:"40%"},{id:"action",accessor:"status",cellWidth:"5%",Cell:t=>{const e=t.row.original;return e.status&&e.status.error?(0,b.jsx)(u.Z,{onClick:()=>V(e),type:"plain",text:"Retry"}):null}}]:[{Header:"Name",accessor:"name"},{Header:"Import As",accessor:"format"}],M=(t,e)=>{const r=[...i],s=r.find((e=>e.path===t));s&&(s.status=e),g(r)},V=async t=>{let e={isLoading:!0};M(t.path,e);try{const r=await(0,Z.n)(t),s="postman_collection"===r.type?await D(r.data,null!=W?W:[]):await L(r.data,null!=P?P:[]);"error"===s.status&&(e={isLoading:!1,error:s.description}),"success"===s.status&&(e={isLoading:!1,success:!0})}catch(t){e={isLoading:!1,error:t.message}}finally{M(t.path,e)}};return(0,a.useEffect)((()=>{if(_)for(const t of i)V(t)}),[_]),(0,b.jsxs)(j,{"data-testid":"import-list-container",children:[(0,b.jsx)(d.Z,{type:"h3",text:`Import Elements (${i.length})`}),(0,b.jsx)(E,{type:"search",value:r,onClear:()=>n(""),onChange:t=>{n(t.target.value)},placeholder:"Search for a file",width:"40%",prefix:(0,b.jsx)(y.Z,{})}),(0,b.jsx)(N,{data:i,columns:F,globalFilter:{filter:r},rowSelected:_?{}:{onSelect:t=>A(t),initialSelectionState:h}}),(0,b.jsx)(S,{justifyContent:"flex-end",children:_?(0,b.jsx)(b.Fragment,{}):(0,b.jsx)(u.Z,{onClick:async()=>{const t=[];for(const e of Object.keys(h))t.push(i[Number(e)]);g(t),T(!0)},type:"primary",text:"Import","data-testid":"import-btn",isDisabled:0===Object.keys(h).length})})]})}},1246:(t,e,r)=>{r.d(e,{Z:()=>a});var s=r(6122);const a=()=>{if(window.NAVIGATION_CONTEXT){const e=JSON.parse(window.NAVIGATION_CONTEXT);try{var t;return JSON.parse(s.Base64.decode(null==e||null==(t=e.options)?void 0:t.importData))}catch(t){return{}}}return{}}}}]);
//# sourceMappingURL=5650.f257d2c20eef041b.js.map