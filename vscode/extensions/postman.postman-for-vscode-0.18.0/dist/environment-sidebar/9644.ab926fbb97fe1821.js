"use strict";(self.webpackChunkenvironment_sidebar=self.webpackChunkenvironment_sidebar||[]).push([[9644],{9644:(e,t,n)=>{n.d(t,{Z:()=>Ze});var i=n(540),a=n.n(i),s=n(5892),r=n.n(s),o=n(605),l=n(8069),d=n(5869),c=n(7560),m=n(207),p=a().createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a().createElement("path",{d:"M15 2H1V3H15V2Z",fill:"#6B6B6B"}),a().createElement("path",{d:"M13.25 5.5H2.75V6.5H13.25V5.5Z",fill:"#6B6B6B"}),a().createElement("path",{d:"M4.5 9.5H11.5V10.5H4.5V9.5Z",fill:"#6B6B6B"}),a().createElement("path",{d:"M9.75 13H6.25V14H9.75V13Z",fill:"#6B6B6B"})),h=a().forwardRef((function(e,t){return a().createElement(m.Z,(0,c.Z)({},e,{svg:p,ref:t}))}));h.getName=function(){return"icon-action-filter-stroke"};const u=h;var v=n(4691),g=n(8263),y=n(9824),x=n(7282),f=n(9225),b=n(8217),C=n(814),w=n(3353),_=n(2465),j=n(5736),N=n(1391);const k=r().div.withConfig({displayName:"styled__ActionMenuContainer",componentId:"sc-eemidz-0"})(["width:32px;"]),E=r().li.withConfig({displayName:"styled__ItemContainer",componentId:"sc-eemidz-1"})(["display:flex;flex-direction:row;justify-content:space-between;height:28px;align-items:center;font-size:var(--text-size-m,12px);overflow:hidden;box-sizing:border-box;color:var(--content-color-primary,var(--grey-90));gap:var(--spacing-s);background-color:",";&:hover{background-color:var(--highlight-background-color-secondary);","{opacity:1;}}","{opacity:",";}"],(e=>e.isActive?"var(--highlight-background-color-secondary)":e.$isOpen?"var(--highlight-background-color-tertiary)":""),k,k,(e=>e.isActive?1:0)),I=r().div.withConfig({displayName:"styled__ItemLinkContainer",componentId:"sc-eemidz-2"})(["overflow:hidden;flex-grow:1;height:100%;"]),Z=r()(w.Link).withConfig({displayName:"styled__ItemLink",componentId:"sc-eemidz-3"})(["display:flex;align-items:center;height:100%;width:100%;color:var(--content-color-primary);&:hover{color:var(--content-color-primary);}"]),L=r().div.withConfig({displayName:"styled__DisabledLinkContainer",componentId:"sc-eemidz-4"})(["display:flex;align-items:center;justify-content:space-between;gap:var(--spacing-s);height:100%;width:100%;color:var(--content-color-primary);cursor:not-allowed;&:hover{color:var(--content-color-primary);}"]),D=r().span.withConfig({displayName:"styled__ItemName",componentId:"sc-eemidz-5"})(["box-sizing:border-box;display:inline-block;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;margin-left:var(--spacing-l);flex:2;max-width:fit-content;"]),z=r().div.withConfig({displayName:"styled__ItemActionZone",componentId:"sc-eemidz-6"})(["display:flex;align-items:center;gap:var(--spacing-xs);"]),B=r()(j.Z).withConfig({displayName:"styled__LoadingSpinner",componentId:"sc-eemidz-7"})(["padding-right:var(--spacing-s);"]),R=r()(N.InlineEditor).withConfig({displayName:"styled__StyledInlineEditor",componentId:"sc-eemidz-8"})(["margin-left:var(--spacing-l);box-sizing:border-box;width:100%;"]);var M=n(3301),O=n(7380),S=n(9461);const A={userCanCreateEnvironment:!0,userCanUpdateGlobals:!0},V=e=>{const{data:t,error:n}=(0,S.useDataFetch)((0,O.getEnvironmentSidebarPermissionsQuery)(e));return n?Object.assign({isLoading:!1},A):t?Object.assign({isLoading:!1},t):Object.assign({isLoading:!0},A)};var H=n(2322),$=function(e){return e.delete="delete",e.duplicate="duplicate",e.rename="rename",e}($||{});const U=e=>e?"You don't have permission to take this action.":"",P=({environmentName:e,environmentId:t,permissions:n,isMenuOpen:i,setIsMenuOpen:a,setIsRenameMode:s})=>{const r=(0,w.useNavigate)(),l=(0,M.useActiveWorkspaceId)(),d=(0,O.useEnvironmentDelete)(),c=(0,O.useEnvironmentDuplicate)(),{userCanCreateEnvironment:m}=V(l),p=b.Modals.getModals(),h=(0,C.getTabManager)(),u=async n=>{if(n===$.delete){const n=await p.showWarningDialog({uid:"delete-environment-confirmation",subject:`Delete "${e}"?`,message:"Deleting this environment might cause any monitors, scheduled runs or mock servers using it to stop functioning properly. Are you sure you want to continue?",options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Delete",isPrimary:!0}]});if(n&&"Delete"===n.title)return h.closeTabByRoute(`/workspace/${l}/environment/${t}`),_.AnalyticsService.addEventV2({category:"environment",action:"delete",label:"sidebar"}),d.mutate({environmentId:t,workspaceId:l})}return n===$.duplicate?c.mutate({environmentId:t,workspaceId:l},{onSuccess:({data:e})=>{r(`/workspace/${l}/environment/${e.owner}-${e.id}`,{},{customNavEvent:w.OPEN_EXTENSION_URL})}}):n===$.rename?s(!0):void 0};return(0,H.jsx)(k,{children:(0,H.jsxs)(v.Z,{isOpen:i,closeMenu:()=>a(!1),children:[(0,H.jsx)(g.Z,{onClick:()=>{a((e=>!e))},children:(0,H.jsx)(o.Z,{"data-testid":"view-more-actions",icon:(0,H.jsx)(f.Z,{}),type:"tertiary",className:"action-menu-icon",tooltip:"View more actions"})}),(0,H.jsxs)(y.Z,{placement:"bottom-end",children:[(0,H.jsx)(x.Z,{isDisabled:!n.userCanUpdate,tooltip:U(!n.userCanUpdate),onClick:()=>u($.rename),children:"Rename"}),(0,H.jsx)(x.Z,{isDisabled:!m,tooltip:U(!m),onClick:()=>u($.duplicate),children:"Duplicate"}),(0,H.jsx)(x.Z,{type:n.userCanDelete?"destructive":"default ",isDisabled:!n.userCanDelete,tooltip:U(!n.userCanDelete),onClick:()=>u($.delete),children:"Delete"})]})]})})};var G=n(8722);const W=()=>{const e=(0,w.useNavigate)(),t=(0,M.useActiveWorkspaceId)(),n=(0,O.useCreateNewEnvironment)(),{userCanCreateEnvironment:a}=V(t);return{userCanCreateEnvironment:a,isCreating:n.isLoading,handler:(0,i.useCallback)((()=>{n.mutate({workspaceId:t,requestBody:{id:(0,G.v4)(),name:"New Environment",values:[]}},{onSuccess:({data:n})=>{_.AnalyticsService.addEventV2({category:"environment",action:"create",label:"sidebar"}),e(`/workspace/${t}/environment/${n.owner}-${n.id}`,{state:JSON.stringify({additionalContext:{rename:!0}})},{customNavEvent:w.OPEN_EXTENSION_URL})}})}),[t,n,e])}},Q=r().div.withConfig({displayName:"environment-sidebar-header__HeaderContainer",componentId:"sc-uidhho-0"})(["display:flex;box-sizing:border-box;align-items:center;margin:var(--spacing-s);"]),T=r()(o.Z).withConfig({displayName:"environment-sidebar-header__CreateNewButton",componentId:"sc-uidhho-1"})(["margin-right:var(--spacing-s);width:var(--size-s);padding:0;height:24px;"]),F=({isCreateNewButtonDisabled:e,searchQuery:t,onSearchQueryChange:n})=>{const{userCanCreateEnvironment:i,isCreating:a,handler:s}=W(),r=e||a||!i;return(0,H.jsxs)(Q,{"data-testid":"create-new-button-container",children:[(0,H.jsx)(T,{icon:(0,H.jsx)(d.Z,{}),type:"tertiary",isDisabled:r,tooltip:U(!i),onClick:s}),(0,H.jsx)(l.Z,{onChange:e=>n(e.target.value),value:t,placeholder:"Filter",prefix:(0,H.jsx)(u,{}),onClear:()=>n(""),"data-testid":"environment-top-bar-search-input","aria-label":"filter-environments"})]})};var X=n(1397),q=n(8560),Y=a().createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a().createElement("path",{d:"M6.5 7.5C6.5 7.22386 6.27614 7 6 7C5.72386 7 5.5 7.22386 5.5 7.5V8.5C5.5 8.77614 5.72386 9 6 9C6.27614 9 6.5 8.77614 6.5 8.5V7.5Z",fill:"#6B6B6B"}),a().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.00001 4.5H2C1.44772 4.5 1 4.94772 1 5.5V10.5C1 11.0523 1.44772 11.5 2 11.5H10C10.5523 11.5 11 11.0523 11 10.5V5.5C11 4.94772 10.5523 4.5 10 4.5H9.00001L9.00001 3.83574C9.00015 3.44371 9.00042 2.62956 8.63336 1.9064C8.44028 1.52602 8.14405 1.16567 7.69829 0.9042C7.2547 0.643999 6.69432 0.5 6 0.5C5.30568 0.5 4.74531 0.643999 4.30172 0.9042C3.85596 1.16567 3.55973 1.52602 3.36666 1.9064C2.9996 2.62955 2.99987 3.4437 3.00001 3.83573L3.00001 4.5ZM4.25836 2.35901C4.00725 2.85375 4.00001 3.45131 4.00001 3.85715V4.5H8.00001L8.00001 3.85715C8.00001 3.45132 7.99277 2.85375 7.74165 2.35901C7.62222 2.12373 7.44971 1.91773 7.19234 1.76676C6.9328 1.61452 6.55568 1.5 6 1.5C5.44433 1.5 5.06721 1.61452 4.80767 1.76676C4.5503 1.91773 4.37779 2.12372 4.25836 2.35901ZM10 5.5H2V10.5H10V5.5Z",fill:"#6B6B6B"})),J=a().forwardRef((function(e,t){return a().createElement(m.Z,(0,c.Z)({},e,{svg:Y,ref:t}))}));J.getName=function(){return"icon-state-locked-stroke-small"};const K=J,ee=({isHidden:e})=>e?null:(0,H.jsx)(q.Z,{padding:{paddingLeft:"spacing-s"},children:(0,H.jsx)(K,{"data-testid":"lock-icon",title:"Read only",color:"content-color-tertiary"})}),te=r()("div").withConfig({displayName:"sidebar-container__Container",componentId:"sc-1y5a9l0-0"})(["display:flex;flex-direction:column;height:100%;"]),ne=r()("div").withConfig({displayName:"sidebar-container__GlobalLinkWrapper",componentId:"sc-1y5a9l0-1"})(["height:28px;flex-shrink:0;background-color:",";&:hover{background-color:var(--highlight-background-color-secondary);}"],(e=>e.$isOpen?"var(--highlight-background-color-tertiary)":"")),ie=r()("hr").withConfig({displayName:"sidebar-container__GlobalsSeparator",componentId:"sc-1y5a9l0-2"})(["border:none;border-top:1px solid var(--border-color-default);width:calc(100% - var(--spacing-xl));"]),ae=({children:e,isCreateNewButtonDisabled:t})=>{const[n,s]=(0,i.useState)(""),r=(0,M.useActiveWorkspaceId)(),o=V(r),l=(0,O.useCurrentEnvironmentId)();return(0,H.jsxs)(te,{children:[(0,H.jsx)(F,{isCreateNewButtonDisabled:t,searchQuery:n,onSearchQueryChange:s}),(0,H.jsx)(ne,{$isOpen:"globals"===l,children:(0,H.jsx)(I,{children:(0,H.jsxs)(Z,{to:`/workspace/${r}/globals`,customNavEvent:w.OPEN_EXTENSION_URL,"customNavEvent-updateURL":!0,children:[(0,H.jsx)(X.Z,{content:"Globals",openDelay:500,placement:"bottom",children:(0,H.jsx)(D,{children:"Globals"})}),(0,H.jsx)(ee,{isHidden:o.userCanUpdateGlobals})]})})}),(0,H.jsx)(ie,{}),a().Children.map(e,(e=>a().isValidElement(e)?a().cloneElement(e,{searchQuery:n}):e))]})};var se=n(47);function re(){return a().createElement(se.Z,{name:"illustration-no-environment"})}const oe=({numLoadingTiles:e=10})=>{const t=Array(e).fill(0);return(0,H.jsx)("div",{className:"sidebar-loading-state_sidebar-loading-state__XG889","data-testid":"sidebar-loading-state",children:t.map(((e,t)=>(0,H.jsx)("div",{className:"sidebar-loading-state_sidebar-loading-state--item__Z1vOR",children:(0,H.jsx)("div",{className:"sidebar-loading-state_sidebar-loading-state__info__qDG37"})},t)))})};var le=n(4962),de=n(9460);const ce=e=>{const t=e.illustration||null;return(0,H.jsxs)("div",{className:"sidebar-empty-state_sidebar-empty-state__zGbOy",children:[(0,H.jsx)("div",{className:"sidebar-empty-state_sidebar-empty-state__illustration__sxdhr",children:t}),(0,H.jsxs)("div",{className:"sidebar-empty-state_sidebar-empty-state__head-and-body__z9GWI",children:[(0,H.jsx)("div",{className:"sidebar-empty-state_sidebar-empty-state__title__C6Q5t",children:(0,H.jsx)(le.Z,{type:"h4",color:"content-color-secondary",text:e.title})}),(0,H.jsx)("div",{className:"sidebar-empty-state_sidebar-empty-state__description__771s1",children:(0,H.jsx)(de.ZP,{type:"body-medium",color:"content-color-secondary",children:e.message})})]}),e.action&&(0,H.jsx)("div",{className:"sidebar-empty-state_sidebar-empty-state__cta__AhqHg",children:(0,H.jsx)(o.Z,{type:"primary",size:"medium",text:e.action.label,disabled:!e.hasPermissions,tooltip:e.action.tooltip,onClick:()=>{e.action&&e.action.handler&&e.action.handler()}})})]})};var me=n(3587),pe=n.n(me),he=n(949),ue=n(7691);const ve=r().div.withConfig({displayName:"fork-label__ForkLabelWrapper",componentId:"sc-5amwpt-0"})(["display:flex;align-items:center;overflow:hidden;margin-left:var(--spacing-s);flex:1;max-width:fit-content;"]),ge=r().p.withConfig({displayName:"fork-label__LabelContainer",componentId:"sc-5amwpt-1"})(["display:inline-block;white-space:nowrap;overflow:hidden;margin-left:var(--spacing-xs);font-size:var(--text-size-s);font-weight:var(--text-weight-regular);text-overflow:ellipsis;color:var(--content-color-tertiary);"]),ye=({label:e})=>e?(0,H.jsxs)(ve,{children:[(0,H.jsx)(ue.Z,{color:"content-color-tertiary",size:"small","data-testid":"fork-icon"}),(0,H.jsx)(X.Z,{content:e,openDelay:500,placement:"bottom",children:(0,H.jsx)(ge,{children:e})})]}):null,xe=({item:e})=>{var t;const n=(0,O.useCurrentEnvironmentId)(),a=(0,M.useActiveWorkspaceId)(),[s,r]=(0,i.useState)(!1),[o,l]=(0,i.useState)(!1),d=(0,O.useUpdateEnvironmentName)();return(0,O.isEnvironmentItemLoading)(e)?(0,H.jsx)(E,{role:"listitem",isActive:!1,children:(0,H.jsxs)(L,{children:[(0,H.jsx)(D,{children:e.name}),(0,H.jsx)(B,{size:"small","data-testid":"env-item-loading"})]})}):(0,H.jsxs)(E,{role:"listitem",isActive:s,$isOpen:n===e.id,onContextMenu:e=>{e.stopPropagation(),r(!0)},children:[(0,H.jsx)(I,{children:(0,H.jsxs)(Z,{to:`/workspace/${a}/environment/${e.id}`,customNavEvent:w.OPEN_EXTENSION_URL,"customNavEvent-updateURL":!0,children:[(0,H.jsx)(X.Z,{content:e.name,openDelay:500,placement:"bottom",children:o?(0,H.jsx)(R,{isEditMode:o,setIsEditMode:l,value:e.name,onSubmit:t=>d.mutate({workspaceId:a,environmentId:e.id,name:t}),onCancel:()=>null}):(0,H.jsx)(D,{children:e.name})}),(0,H.jsx)(ye,{label:null==(t=e.attributes.fork)?void 0:t.forkLabel}),(0,H.jsx)(ee,{isHidden:e.attributes.permissions.userCanUpdate})]})}),(0,H.jsx)(z,{children:(0,H.jsx)(P,{permissions:e.attributes.permissions,environmentName:e.name,environmentId:e.id,isMenuOpen:s,setIsMenuOpen:r,setIsRenameMode:l})})]})},fe=({index:e,data:t,style:n})=>{const{items:i}=t,a=i[e];return a?(0,H.jsx)("div",{style:n,children:(0,H.jsx)(xe,{item:a},a.id)}):null},be=r().div.withConfig({displayName:"styled__SidebarListContainer",componentId:"sc-1dfoij9-0"})(["height:100%;"]),Ce=(e,{items:t})=>{const n=t[e];return n?n.id:"0"},we=({items:e})=>(0,H.jsx)(be,{role:"list",children:(0,H.jsx)(pe(),{children:({height:t,width:n})=>(0,H.jsx)(he.VariableSizeList,{itemKey:Ce,height:t,width:n,overscanCount:10,itemSize:()=>28,itemData:{items:e},itemCount:e.length,children:fe})})}),_e=r().div.withConfig({displayName:"refetch-item__MetaContainer",componentId:"sc-l9flvp-0"})(["height:100%;width:100%;display:flex;align-items:center;justify-content:center;font-size:var(--text-size-m);line-height:var(--line-height-m);padding:var(--spacing-xs) 0;color:var(--content-color-tertiary);"]),je=r().button.withConfig({displayName:"refetch-item__RetryButton",componentId:"sc-l9flvp-1"})(["all:unset;color:var(--content-color-brand);cursor:pointer;display:inline-block;margin-left:var(--spacing-xs);"]),Ne=r().div.withConfig({displayName:"refetch-item__SpinnerWrapper",componentId:"sc-l9flvp-2"})(["height:100%;display:flex;align-items:center;justify-content:center;"]);function ke({isRefetching:e,onRetry:t}){return e?(0,H.jsx)(_e,{children:(0,H.jsx)(Ne,{children:(0,H.jsx)(j.Z,{size:"small"})})}):(0,H.jsx)(_e,{children:(0,H.jsxs)(de.ZP,{type:"para",children:["Unable to load items.",t&&(0,H.jsx)(je,{onClick:t,children:"Retry"})]})})}const Ee=({isError:e,isLoading:t,isRefetching:n,refetch:i,items:a,searchQuery:s=""})=>{const{userCanCreateEnvironment:r,isCreating:o,handler:l}=W();if(e)return(0,H.jsx)(ke,{isRefetching:n,onRetry:i});if(t)return(0,H.jsx)(oe,{});if(!Array.isArray(a))return(0,H.jsx)(ke,{isRefetching:n,onRetry:i});if(0===a.length)return(0,H.jsx)(ce,{illustration:(0,H.jsx)(re,{}),title:"You don’t have any environments.",message:"An environment is a set of variables that allows you to switch the context of your requests.",hasPermissions:r&&!o,action:{label:"Create Environment",handler:l,tooltip:"Create new environment"}});const d=s?a.filter((e=>{var t;return null==e||null==(t=e.name)?void 0:t.toLowerCase().includes(s.toLowerCase())})):a;return s&&0===d.length?(0,H.jsx)(ce,{illustration:(0,H.jsx)(re,{}),title:`No results found for "${s}"`,message:"Please try again using different keywords, and don’t forget to check for typos.",hasPermissions:!1}):(0,H.jsx)(we,{items:d})},Ie=()=>{const e=(0,M.useActiveWorkspaceId)(),t=V(e),{data:n,isError:i,isRefetching:a,refetch:s}=(0,O.useEnvironmentItems)({workspaceId:e});(0,O.useEnvironmentListSubscription)(e);const r=!n||t.isLoading,o=Array.isArray(n),l=i||r||!o;return(0,H.jsxs)(ae,{isCreateNewButtonDisabled:l,children:[(0,H.jsx)(Ee,{isLoading:r,isError:i,isRefetching:a,refetch:s,items:n}),(0,H.jsx)(b.Modals.Ui.ModalDialog,{uid:"delete-environment-confirmation"})]})},Ze=()=>(0,O.useEnvironmentFeatureFlag)()?(0,H.jsx)(Ie,{}):null}}]);
//# sourceMappingURL=9644.ab926fbb97fe1821.js.map